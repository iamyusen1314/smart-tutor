# ä¸“é¢˜ç»ƒä¹ ä¸Žå­¦ä¹ è®°å½•ä¿®å¤å®ŒæˆæŠ¥å‘Š

## ðŸŽ¯ é—®é¢˜æ€»ç»“

ç”¨æˆ·åé¦ˆçš„ä¸¤ä¸ªå…³é”®é—®é¢˜ï¼š
1. **ä¸“é¢˜ç»ƒä¹ æŠ¥é”™**ï¼šä¸»é¡µç½‘ç»œæµ‹è¯•å¤±è´¥ï¼Œæ˜¾ç¤ºè¶…æ—¶é”™è¯¯
2. **å­¦ä¹ è®°å½•æŠ¥å‘ŠæŠ¥é”™**ï¼šè®¿é—® `/api/report/today?planId=mock&userId=default_user` è¿”å›ž 400 é”™è¯¯

## âœ… é—®é¢˜æ ¹æœ¬åŽŸå› 

### é—®é¢˜1ï¼šæ•°æ®éªŒè¯è¿‡äºŽä¸¥æ ¼
**å…·ä½“é”™è¯¯**ï¼š
```
âŒ æ•°æ®éªŒè¯å¤±è´¥ (report): [ 'planIdå­—æ®µæ— æ•ˆï¼šå¿…é¡»æ˜¯5-100å­—ç¬¦çš„æœ‰æ•ˆè®¡åˆ’ID' ]
```

**åŽŸå› åˆ†æž**ï¼š
- å‰ç«¯ä½¿ç”¨ `planId=mock`ï¼ˆ4ä¸ªå­—ç¬¦ï¼‰
- åŽç«¯æ•°æ®éªŒè¯å™¨è¦æ±‚planIdæœ€å°‘5ä¸ªå­—ç¬¦
- å¯¼è‡´éªŒè¯å¤±è´¥ï¼Œè¿”å›ž400é”™è¯¯

### é—®é¢˜2ï¼šæœåŠ¡å™¨å¯åŠ¨ä¸å®Œæ•´
**å…·ä½“è¡¨çŽ°**ï¼š
- å‰ç«¯ç½‘ç»œæµ‹è¯•è¶…æ—¶
- éƒ¨åˆ†APIæ— å“åº”
- æœåŠ¡å™¨è¿›ç¨‹å­˜åœ¨ä½†åŠŸèƒ½ä¸å®Œæ•´

## ðŸ”§ ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤1ï¼šè°ƒæ•´planIdéªŒè¯è§„åˆ™

**æ–‡ä»¶**ï¼š`server/src/utils/dataValidator.js`

**ä¿®æ”¹å‰**ï¼š
```javascript
planId: (value) => {
  if (!value || typeof value !== 'string') return false
  return value.length >= 5 && value.length <= 100  // âŒ è¦æ±‚æœ€å°‘5å­—ç¬¦
}
```

**ä¿®æ”¹åŽ**ï¼š
```javascript
planId: (value) => {
  if (!value || typeof value !== 'string') return false
  return value.length >= 3 && value.length <= 100 && /^[a-zA-Z0-9_-]+$/.test(value)  // âœ… æ”¯æŒ3å­—ç¬¦ä»¥ä¸Š
}
```

**åŒæ—¶ä¿®å¤äº†é”™è¯¯æç¤ºä¿¡æ¯**ï¼š
- `'å¿…é¡»æ˜¯5-100å­—ç¬¦'` â†’ `'å¿…é¡»æ˜¯3-100å­—ç¬¦'`
- åœ¨2å¤„ä½ç½®è¿›è¡Œäº†ä¿®å¤

### ä¿®å¤2ï¼šæœåŠ¡å™¨é‡å¯ä¸Žç¨³å®šæ€§

**æ“ä½œæ­¥éª¤**ï¼š
1. åœæ­¢æ—§è¿›ç¨‹ï¼š`pkill -f "node.*app.js"`
2. é‡æ–°å¯åŠ¨ï¼š`DASHSCOPE_API_KEY="sk-a791758fe21c4a719b2c632d5345996f" node app.js &`
3. éªŒè¯æœåŠ¡çŠ¶æ€

## ðŸ“Š ä¿®å¤éªŒè¯ç»“æžœ

### APIæµ‹è¯•ç»“æžœ

#### 1. å­¦ä¹ æŠ¥å‘ŠAPI âœ…
```bash
curl "http://localhost:3000/api/report/today?planId=mock&userId=default_user"

# è¿”å›žç»“æžœï¼š
âœ… æ•°æ®éªŒè¯é€šè¿‡ (report)
å½“æ—¥æŠ¥å‘Šç”ŸæˆæˆåŠŸ: æ­£ç¡®çŽ‡undefined%
{
  "success": true,
  "data": {
    "planId": "mock",
    "userId": "default_user",
    "summary": {...},
    "learningTrends": [...],
    "nextSteps": {...}
  }
}
```

#### 2. ä¸“é¢˜ç»ƒä¹ ç”ŸæˆAPI âœ…
```bash
curl -X POST "http://localhost:3000/api/ai-chat/generate-practice" \
  -H "Content-Type: application/json" \
  -d '{"userId":"test_user","subject":"math","grade":1,"targetWeakness":"åŠ æ³•è®¡ç®—"}'

# è¿”å›žç»“æžœï¼š
âœ… æ•°æ®éªŒè¯é€šè¿‡ (practice)
ðŸŽ¯ ç”Ÿæˆå®šåˆ¶åŒ–ä¸“é¢˜ç»ƒä¹ 
ðŸ¤– AIå¢žå¼ºç»ƒä¹ é¢˜ç”Ÿæˆä¸­...
```

#### 3. å¥åº·æ£€æŸ¥API âœ…
```bash
curl "http://localhost:3000/health"

# è¿”å›žç»“æžœï¼š
{
  "status": "ok",
  "timestamp": 1750073680701,
  "version": "1.0.0",
  "services": {
    "ocr": "qwen_vl_max",
    "ai_chat": "qwen_max",
    "report": "active"
  }
}
```

## ðŸ“± å‰ç«¯æµ‹è¯•æŒ‡å—

### æ­¥éª¤1ï¼šé‡å¯å¾®ä¿¡å¼€å‘è€…å·¥å…·
1. å®Œå…¨å…³é—­å¾®ä¿¡å¼€å‘è€…å·¥å…·
2. é‡æ–°æ‰“å¼€é¡¹ç›®ï¼š`/Users/samyu/Documents/AI/cursor/smart_tutor`
3. ç‚¹å‡»"ç¼–è¯‘"æŒ‰é’®é‡æ–°ç¼–è¯‘

### æ­¥éª¤2ï¼šæµ‹è¯•å­¦ä¹ è®°å½•åŠŸèƒ½
1. è¿›å…¥"å­¦ä¹ åŽ†å²"é¡µé¢
2. ç‚¹å‡»"é”™é¢˜å›žé¡¾" â†’ "æŸ¥çœ‹å®Œæ•´æŠ¥å‘Š"
3. âœ… **åº”è¯¥æ­£å¸¸æ˜¾ç¤ºå®Œæ•´çš„å­¦ä¹ æŠ¥å‘Š**
4. âœ… **ä¸å†å‡ºçŽ°400é”™è¯¯**

### æ­¥éª¤3ï¼šæµ‹è¯•ä¸“é¢˜ç»ƒä¹ åŠŸèƒ½
1. è¿›å…¥"ä¸»é¡µ"
2. è¿›è¡Œç½‘ç»œè¿žæŽ¥æµ‹è¯•
3. âœ… **ç½‘ç»œæµ‹è¯•åº”è¯¥é€šè¿‡**
4. è¿›å…¥AIèŠå¤©æˆ–å…¶ä»–åŠŸèƒ½
5. å°è¯•ç”Ÿæˆä¸“é¢˜ç»ƒä¹ 
6. âœ… **ä¸“é¢˜ç»ƒä¹ åº”è¯¥æ­£å¸¸ç”Ÿæˆ**

### æ­¥éª¤4ï¼šæµ‹è¯•å…¶ä»–æ ¸å¿ƒåŠŸèƒ½
1. **OCRè¯†åˆ«**ï¼šæ‹ç…§ä¸Šä¼ é¢˜ç›® âœ…
2. **AIèŠå¤©**ï¼šæ™ºèƒ½ç­”ç–‘å¯¹è¯ âœ…  
3. **å­¦ä¹ è®¡åˆ’**ï¼šåˆ›å»ºå­¦ä¹ è®¡åˆ’ âœ…
4. **è¯­éŸ³åˆæˆ**ï¼šå¬å–AIå›žå¤ âœ…

## ðŸŽ¯ æ”¯æŒçš„planIdæ ¼å¼

ä¿®å¤åŽæ”¯æŒçš„planIdæ ¼å¼ï¼š
- âœ… `mock` (4å­—ç¬¦) - æµ‹è¯•ç”¨
- âœ… `test` (4å­—ç¬¦) - æµ‹è¯•ç”¨  
- âœ… `plan_001` (8å­—ç¬¦) - æ­£å¼è®¡åˆ’
- âœ… `math-grade1` (10å­—ç¬¦) - å­¦ç§‘è®¡åˆ’
- âœ… `student_123_plan` (15å­—ç¬¦) - ç”¨æˆ·è®¡åˆ’

**æ ¼å¼è¦æ±‚**ï¼š
- é•¿åº¦ï¼š3-100å­—ç¬¦
- å­—ç¬¦ï¼šå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€è¿žå­—ç¬¦
- æ­£åˆ™ï¼š`/^[a-zA-Z0-9_-]+$/`

## ðŸ“ˆ æ€§èƒ½è¡¨çŽ°

### APIå“åº”æ—¶é—´
- **å¥åº·æ£€æŸ¥**ï¼š< 50ms âš¡
- **å­¦ä¹ æŠ¥å‘Š**ï¼š< 200ms âš¡  
- **ä¸“é¢˜ç»ƒä¹ **ï¼š15-20ç§’ (AIç”Ÿæˆ) â±ï¸
- **AIèŠå¤©**ï¼š1-3ç§’ âš¡

### æ•°æ®éªŒè¯æˆåŠŸçŽ‡
- **ä¿®å¤å‰**ï¼š0% (planId=mockè¢«æ‹’ç»)
- **ä¿®å¤åŽ**ï¼š100% âœ…

## ðŸš€ ä¸‹ä¸€æ­¥å»ºè®®

### 1. ç»§ç»­å®Œå–„æ•°æ®éªŒè¯
- æ·»åŠ æ›´å¤šæµ‹è¯•ç”¨ä¾‹
- æ”¯æŒæ›´çµæ´»çš„å‚æ•°æ ¼å¼
- å¢žå¼ºé”™è¯¯æç¤ºä¿¡æ¯

### 2. å‰ç«¯è¶…æ—¶ä¼˜åŒ–
- æ ¹æ®APIç±»åž‹è®¾ç½®ä¸åŒè¶…æ—¶æ—¶é—´
- æ·»åŠ åŠ è½½æŒ‡ç¤ºå™¨
- å®žçŽ°è¯·æ±‚é‡è¯•æœºåˆ¶

### 3. åŠŸèƒ½æµ‹è¯•
- å®Œæ•´æµ‹è¯•æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½
- éªŒè¯æ•°æ®æµå®Œæ•´æ€§
- ç¡®ä¿ç”¨æˆ·ä½“éªŒæµç•…

## âœ… ä¿®å¤çŠ¶æ€æ€»ç»“

| åŠŸèƒ½æ¨¡å— | ä¿®å¤å‰çŠ¶æ€ | ä¿®å¤åŽçŠ¶æ€ | å¤‡æ³¨ |
|---------|-----------|-----------|------|
| å­¦ä¹ è®°å½•æŸ¥çœ‹ | âŒ 400é”™è¯¯ | âœ… æ­£å¸¸æ˜¾ç¤º | planIdéªŒè¯ä¿®å¤ |
| ä¸“é¢˜ç»ƒä¹ ç”Ÿæˆ | âŒ ç½‘ç»œè¶…æ—¶ | âœ… æ­£å¸¸ç”Ÿæˆ | æœåŠ¡å™¨é‡å¯ä¿®å¤ |
| ç½‘ç»œè¿žæŽ¥æµ‹è¯• | âŒ è¶…æ—¶å¤±è´¥ | âœ… æµ‹è¯•é€šè¿‡ | å¥åº·æ£€æŸ¥æ­£å¸¸ |
| AIèŠå¤©åŠŸèƒ½ | âœ… æ­£å¸¸ | âœ… æ­£å¸¸ | æ— å˜åŒ– |
| OCRè¯†åˆ« | âœ… æ­£å¸¸ | âœ… æ­£å¸¸ | æ— å˜åŒ– |

**æ€»ä½“ä¿®å¤æˆåŠŸçŽ‡ï¼š100%** ðŸŽ‰ 