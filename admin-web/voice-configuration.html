<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ™ï¸ è¯­éŸ³åŠŸèƒ½é…ç½®æŒ‡å—</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f7fa;
            color: #333;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .title {
            text-align: center;
            color: #4A90E2;
            margin-bottom: 30px;
        }
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .alert-warning { background: #fff3cd; border: 1px solid #ffeaa7; color: #856404; }
        .alert-success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .alert-info { background: #d1ecf1; border: 1px solid #bee5eb; color: #0c5460; }
        .code {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 12px;
            font-family: monospace;
            margin: 10px 0;
        }
        .btn {
            background: #4A90E2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover { background: #357abd; }
        .section {
            margin: 30px 0;
            padding: 20px;
            border-left: 4px solid #4A90E2;
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">ğŸ™ï¸ å³æ—¶è¯­éŸ³èŠå¤©åŠŸèƒ½é…ç½®</h1>
        
        <div class="alert alert-warning">
            <strong>âš ï¸ å½“å‰çŠ¶æ€ï¼šæ¨¡æ‹Ÿæ¨¡å¼</strong><br>
            æ‚¨å‘ç°çš„é—®é¢˜å®Œå…¨æ­£ç¡®ï¼šå½•éŸ³å†…å®¹ä¸æ˜¾ç¤ºæ–‡å­—ä¸ä¸€è‡´ï¼ŒAIä¹Ÿæ²¡æœ‰çœŸå®è¯­éŸ³å›å¤ã€‚
            è¿™æ˜¯å› ä¸ºå½“å‰è¯­éŸ³åŠŸèƒ½è¿è¡Œåœ¨æ¨¡æ‹Ÿæ¨¡å¼ä¸‹ã€‚
        </div>

        <div class="section">
            <h2>ğŸ” é—®é¢˜åˆ†æ</h2>
            <h3>1. è¯­éŸ³è¯†åˆ«é—®é¢˜</h3>
            <p>å½“å‰ç³»ç»Ÿéšæœºè¿”å›ä»¥ä¸‹é¢„è®¾æ–‡æœ¬ä¹‹ä¸€ï¼š</p>
            <div class="code">
'æˆ‘ä¸çŸ¥é“æ€ä¹ˆç®—'
'è€å¸ˆèƒ½å¸®å¸®æˆ‘å—' 
'æˆ‘éœ€è¦æç¤º'
'è¿™é“é¢˜å¥½éš¾'
'æˆ‘æƒ³å†è¯•ä¸€æ¬¡'
...</div>
            
            <h3>2. è¯­éŸ³åˆæˆé—®é¢˜</h3>
            <p>AIå›å¤åªæ˜¯æ¨¡æ‹Ÿæ’­æ”¾ï¼Œæ²¡æœ‰çœŸå®éŸ³é¢‘ç”Ÿæˆ</p>
            
            <h3>3. æ ¹æœ¬åŸå› </h3>
            <p>ç¼ºå°‘é˜¿é‡Œäº‘DashScope APIå¯†é’¥é…ç½®</p>
        </div>

        <div class="section">
            <h2>ğŸ”§ è§£å†³æ–¹æ¡ˆ</h2>
            
            <h3>æ­¥éª¤1ï¼šè·å–é˜¿é‡Œäº‘APIå¯†é’¥</h3>
            <ol>
                <li>è®¿é—® <a href="https://dashscope.console.aliyun.com/" target="_blank">é˜¿é‡Œäº‘DashScopeæ§åˆ¶å°</a></li>
                <li>æ³¨å†Œ/ç™»å½•è´¦æˆ·</li>
                <li>åˆ›å»ºAPIå¯†é’¥ï¼ˆæ ¼å¼ç±»ä¼¼ï¼šsk-xxxxxxxxxxxxxxxxï¼‰</li>
                <li>è®°å½•æ‚¨çš„APIå¯†é’¥</li>
            </ol>

            <h3>æ­¥éª¤2ï¼šé…ç½®ç¯å¢ƒå˜é‡</h3>
            <p>åœ¨æœåŠ¡å™¨æ ¹ç›®å½•åˆ›å»ºæˆ–ç¼–è¾‘ <code>server/.env</code> æ–‡ä»¶ï¼š</p>
            <div class="code">
# åœ¨ server/.env æ–‡ä»¶ä¸­æ·»åŠ 
DASHSCOPE_API_KEY=æ‚¨çš„çœŸå®APIå¯†é’¥

# ç¤ºä¾‹ï¼š
# DASHSCOPE_API_KEY=sk-1234567890abcdef
            </div>

            <h3>æ­¥éª¤3ï¼šé‡å¯æœåŠ¡å™¨</h3>
            <div class="code">
cd server
npm start
            </div>

            <h3>æ­¥éª¤4ï¼šéªŒè¯é…ç½®</h3>
            <button class="btn" onclick="checkStatus()">ğŸ” æ£€æŸ¥è¯­éŸ³æœåŠ¡çŠ¶æ€</button>
            <div id="statusResult"></div>
        </div>

        <div class="section">
            <h2>ğŸ® æµ‹è¯•è¯­éŸ³åŠŸèƒ½</h2>
            <p>é…ç½®å®Œæˆåï¼Œæ‚¨å¯ä»¥æµ‹è¯•ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
            
            <h3>è¯­éŸ³è¯†åˆ«æµ‹è¯•</h3>
            <button class="btn" onclick="testRecognition()">ğŸ¤ æµ‹è¯•è¯­éŸ³è¯†åˆ«</button>
            <div id="recognitionResult"></div>
            
            <h3>è¯­éŸ³åˆæˆæµ‹è¯•</h3>
            <input type="text" id="testText" placeholder="è¾“å…¥æµ‹è¯•æ–‡å­—..." style="width: 60%; padding: 8px;">
            <button class="btn" onclick="testSynthesis()">ğŸ”Š æµ‹è¯•è¯­éŸ³åˆæˆ</button>
            <div id="synthesisResult"></div>
        </div>

        <div class="section">
            <h2>ğŸ“‹ é¢„æœŸæ•ˆæœ</h2>
            <div class="alert alert-success">
                <strong>âœ… é…ç½®æˆåŠŸåçš„æ•ˆæœï¼š</strong>
                <ul>
                    <li>å½•éŸ³å†…å®¹ä¼šè¢«çœŸå®è¯†åˆ«å¹¶è½¬æ¢ä¸ºæ–‡å­—</li>
                    <li>AIä¼šæ ¹æ®è¯†åˆ«çš„å†…å®¹ç»™å‡ºé’ˆå¯¹æ€§å›å¤</li>
                    <li>AIå›å¤ä¼šè¢«åˆæˆä¸ºçœŸå®çš„è¯­éŸ³å¹¶æ’­æ”¾</li>
                    <li>æœåŠ¡çŠ¶æ€æ˜¾ç¤º "provider: alibaba-cloud"</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>ğŸš¨ æ•…éšœæ’é™¤</h2>
            <details>
                <summary>â“ APIå¯†é’¥é…ç½®åä»ç„¶æ˜¯æ¨¡æ‹Ÿæ¨¡å¼</summary>
                <p>è¯·æ£€æŸ¥ï¼š</p>
                <ul>
                    <li>APIå¯†é’¥æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆä»¥sk-å¼€å¤´ï¼‰</li>
                    <li>æ˜¯å¦é‡å¯äº†æœåŠ¡å™¨</li>
                    <li>ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®</li>
                </ul>
            </details>
            
            <details>
                <summary>â“ è¯­éŸ³è¯†åˆ«å¤±è´¥</summary>
                <p>å¯èƒ½åŸå› ï¼š</p>
                <ul>
                    <li>APIå¯†é’¥é¢åº¦ä¸è¶³</li>
                    <li>ç½‘ç»œè¿æ¥é—®é¢˜</li>
                    <li>éŸ³é¢‘æ ¼å¼ä¸æ”¯æŒ</li>
                </ul>
            </details>
        </div>
    </div>

    <script>
        async function checkStatus() {
            const result = document.getElementById('statusResult');
            result.innerHTML = 'æ£€æŸ¥ä¸­...';
            
            try {
                const response = await fetch('/api/speech/status');
                const data = await response.json();
                
                if (data.success) {
                    const status = data.data;
                    result.innerHTML = `
                        <div class="alert ${status.configured ? 'alert-success' : 'alert-warning'}">
                            <strong>é…ç½®çŠ¶æ€ï¼š</strong> ${status.configured ? 'âœ… å·²é…ç½®çœŸå®API' : 'âš ï¸ æ¨¡æ‹Ÿæ¨¡å¼'}<br>
                            <strong>è¯­éŸ³è¯†åˆ«ï¼š</strong> ${status.speechRecognition.provider}<br>
                            <strong>è¯­éŸ³åˆæˆï¼š</strong> ${status.speechSynthesis.provider}<br>
                            ${status.configured ? 
                                '<strong>ğŸ‰ æ­å–œï¼è¯­éŸ³åŠŸèƒ½å·²æ­£ç¡®é…ç½®</strong>' : 
                                '<strong>âš ï¸ è¯·æŒ‰ç…§ä¸Šè¿°æ­¥éª¤é…ç½®APIå¯†é’¥</strong>'
                            }
                        </div>
                    `;
                } else {
                    result.innerHTML = `<div class="alert alert-warning">âŒ æ— æ³•è·å–çŠ¶æ€</div>`;
                }
            } catch (error) {
                result.innerHTML = `<div class="alert alert-warning">âŒ è¿æ¥å¤±è´¥: ${error.message}</div>`;
            }
        }

        async function testRecognition() {
            const result = document.getElementById('recognitionResult');
            result.innerHTML = 'æµ‹è¯•ä¸­...';
            
            try {
                const response = await fetch('/api/speech/recognize', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ audioData: 'demo_audio_data' })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    result.innerHTML = `
                        <div class="alert alert-info">
                            <strong>è¯†åˆ«ç»“æœï¼š</strong> "${data.data.text}"<br>
                            <strong>æä¾›å•†ï¼š</strong> ${data.data.provider}<br>
                            <strong>å“åº”æ—¶é—´ï¼š</strong> ${data.data.responseTime}ms
                        </div>
                    `;
                } else {
                    result.innerHTML = `<div class="alert alert-warning">âŒ æµ‹è¯•å¤±è´¥</div>`;
                }
            } catch (error) {
                result.innerHTML = `<div class="alert alert-warning">âŒ æµ‹è¯•å¤±è´¥: ${error.message}</div>`;
            }
        }

        async function testSynthesis() {
            const text = document.getElementById('testText').value || 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIè€å¸ˆ';
            const result = document.getElementById('synthesisResult');
            result.innerHTML = 'åˆæˆä¸­...';
            
            try {
                const response = await fetch('/api/speech/synthesis', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text, voice: 'xiaoyun' })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    result.innerHTML = `
                        <div class="alert alert-info">
                            <strong>åˆæˆæ–‡æœ¬ï¼š</strong> "${data.data.text}"<br>
                            <strong>æä¾›å•†ï¼š</strong> ${data.data.provider}<br>
                            <strong>å“åº”æ—¶é—´ï¼š</strong> ${data.data.responseTime}ms<br>
                            ${data.data.provider === 'alibaba-cloud' ? 
                                '<strong>âœ… çœŸå®è¯­éŸ³å·²ç”Ÿæˆ</strong>' : 
                                '<strong>âš ï¸ æ¨¡æ‹Ÿæ¨¡å¼ï¼ˆé…ç½®APIåå¯å¬åˆ°å£°éŸ³ï¼‰</strong>'
                            }
                        </div>
                    `;
                } else {
                    result.innerHTML = `<div class="alert alert-warning">âŒ åˆæˆå¤±è´¥</div>`;
                }
            } catch (error) {
                result.innerHTML = `<div class="alert alert-warning">âŒ åˆæˆå¤±è´¥: ${error.message}</div>`;
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥çŠ¶æ€
        window.onload = checkStatus;
    </script>
</body>
</html> 