import{_ as v,c as i,a as t,d as g,t as r,F as u,r as h,n as f,i as j,b as S,o as n}from"./index-Dk_8qRP-.js";const k={name:"Subjects",data(){return{loading:!1,error:null,subjects:[],stats:{totalSubjects:0,totalSkills:0,totalGrades:0,totalErrors:0}}},async mounted(){await this.loadSubjects()},methods:{async loadSubjects(){this.loading=!0,this.error=null;try{console.log("ğŸ“ å¼€å§‹åŠ è½½ç§‘ç›®æ•°æ®...");const e="/api/ai-chat/subjects";console.log("ğŸ“¡ è¯·æ±‚åœ°å€:",e);const s=await S.get(e);if(console.log("ğŸ“¦ APIå“åº”:",s),!s)throw new Error("APIå“åº”ä¸ºç©º");if(!s.data)throw new Error("APIå“åº”æ•°æ®ä¸ºç©º");if(console.log("ğŸ“Š å“åº”æ•°æ®ç»“æ„:",{hasData:!!s.data,hasSuccess:!!s.data.success,successValue:s.data.success,hasDataData:!!s.data.data,hasSubjects:!!(s.data.data&&s.data.data.subjects),subjectsLength:s.data.data&&s.data.data.subjects?s.data.data.subjects.length:0}),s.data.success===!0)if(s.data.data&&s.data.data.subjects)this.subjects=s.data.data.subjects,console.log("âœ… ä½¿ç”¨æ ‡å‡†æ ¼å¼åŠ è½½ç§‘ç›®æ•°æ®:",this.subjects.length,"ä¸ªç§‘ç›®");else throw new Error("å“åº”æ•°æ®ä¸­ç¼ºå°‘subjectså­—æ®µ");else if(Array.isArray(s.data))this.subjects=s.data,console.log("âœ… ä½¿ç”¨æ•°ç»„æ ¼å¼åŠ è½½ç§‘ç›®æ•°æ®:",this.subjects.length,"ä¸ªç§‘ç›®");else if(s.data.subjects)this.subjects=s.data.subjects,console.log("âœ… ä½¿ç”¨ç›´æ¥æ ¼å¼åŠ è½½ç§‘ç›®æ•°æ®:",this.subjects.length,"ä¸ªç§‘ç›®");else throw console.error("âŒ æœªçŸ¥çš„æ•°æ®æ ¼å¼:",s.data),new Error(`ç§‘ç›®æ•°æ®æ ¼å¼é”™è¯¯: ${JSON.stringify(s.data).substring(0,200)}...`);if(!Array.isArray(this.subjects))throw new Error("ç§‘ç›®æ•°æ®ä¸æ˜¯æ•°ç»„æ ¼å¼");this.subjects.length===0&&console.warn("âš ï¸ ç§‘ç›®æ•°æ®ä¸ºç©º"),this.subjects.forEach((a,b)=>{(!a.key||!a.name)&&console.warn(`âš ï¸ ç§‘ç›® ${b} ç¼ºå°‘å¿…è¦å­—æ®µ:`,a)}),this.calculateStats(),console.log("âœ… ç§‘ç›®æ•°æ®åŠ è½½å’Œç»Ÿè®¡è®¡ç®—å®Œæˆ:",{subjectsCount:this.subjects.length,stats:this.stats})}catch(e){console.error("âŒ ç§‘ç›®æ•°æ®åŠ è½½å¤±è´¥:",{error:e.message,stack:e.stack,response:e.response}),e.response?e.response.status===404?this.error="APIæ¥å£ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€":e.response.status===500?this.error="æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•":this.error=`ç½‘ç»œé”™è¯¯ (${e.response.status}): ${e.response.statusText}`:e.message.includes("ç§‘ç›®æ•°æ®æ ¼å¼é”™è¯¯")?this.error=`æ•°æ®æ ¼å¼é”™è¯¯: ${e.message}`:e.message.includes("Network Error")?this.error="ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–æœåŠ¡å™¨çŠ¶æ€":this.error=e.message||"åŠ è½½ç§‘ç›®ä¿¡æ¯å¤±è´¥",this.subjects=[],this.calculateStats()}finally{this.loading=!1}},calculateStats(){if(!this.subjects||this.subjects.length===0){this.stats={totalSubjects:0,totalSkills:0,totalGrades:0,totalErrors:0};return}this.stats.totalSubjects=this.subjects.length,this.stats.totalSkills=this.subjects.reduce((s,a)=>s+(a.skillTypes?a.skillTypes.length:0),0);const e=new Set;this.subjects.forEach(s=>{s.grades&&s.grades.forEach(a=>e.add(a))}),this.stats.totalGrades=e.size,this.stats.totalErrors=this.subjects.reduce((s,a)=>s+(a.commonErrors?a.commonErrors.length:0),0),console.log("ğŸ“Š ç»Ÿè®¡æ•°æ®è®¡ç®—å®Œæˆ:",this.stats)},getSubjectsForGrade(e){return this.subjects.filter(s=>s.grades&&s.grades.includes(e))},getSubjectColor(e){return{math:"#FF6B6B",chinese:"#4ECDC4",english:"#45B7D1",science:"#96CEB4"}[e]||"#9B59B6"},scrollToSubjects(){var e;(e=this.$refs.subjectsSection)==null||e.scrollIntoView({behavior:"smooth",block:"start"})},scrollToSkills(){var e,s;(s=(e=this.$refs.skillsSection)==null?void 0:e[0])==null||s.scrollIntoView({behavior:"smooth",block:"start"})},scrollToGrades(){var e;(e=this.$refs.gradesSection)==null||e.scrollIntoView({behavior:"smooth",block:"start"})},scrollToErrors(){var e,s;(s=(e=this.$refs.errorsSection)==null?void 0:e[0])==null||s.scrollIntoView({behavior:"smooth",block:"start"})},viewSubjectDetail(e){console.log("æŸ¥çœ‹ç§‘ç›®è¯¦æƒ…:",e.name)}}},m={class:"subjects-management"},p={class:"stats-cards"},y={class:"stat-info"},_={class:"stat-info"},w={class:"stat-info"},E={class:"stat-info"},C={class:"subjects-list",ref:"subjectsSection"},T={class:"subject-grid"},G=["onClick"],B={class:"subject-header"},I={class:"subject-icon"},A={class:"subject-description"},D={class:"subject-stats"},F={class:"stat-item"},V={class:"stat-value"},x={class:"stat-item"},N={class:"stat-value"},P={class:"stat-item"},z={class:"stat-value"},L={class:"skill-tags"},J={class:"error-tags"},O={class:"grade-distribution",ref:"gradesSection"},U={class:"grade-chart"},q={class:"grade-label"},H={class:"grade-subjects"},K={class:"grade-count"},M={key:0,class:"loading"},Q={key:1,class:"error-message"};function R(e,s,a,b,d,o){return n(),i("div",m,[s[21]||(s[21]=t("div",{class:"page-header"},[t("h1",null,"ğŸ“ ç§‘ç›®ç®¡ç†"),t("p",null,"ç®¡ç†è¯­æ–‡ã€æ•°å­¦ã€è‹±è¯­ã€ç§‘å­¦å››é—¨æ ¸å¿ƒç§‘ç›®")],-1)),t("div",p,[t("div",{class:"stat-card",onClick:s[0]||(s[0]=(...l)=>o.scrollToSubjects&&o.scrollToSubjects(...l))},[s[6]||(s[6]=t("div",{class:"stat-icon"},"ğŸ“š",-1)),t("div",y,[t("h3",null,r(d.stats.totalSubjects),1),s[5]||(s[5]=t("p",null,"ç§‘ç›®æ€»æ•°",-1))])]),t("div",{class:"stat-card",onClick:s[1]||(s[1]=(...l)=>o.scrollToSkills&&o.scrollToSkills(...l))},[s[8]||(s[8]=t("div",{class:"stat-icon"},"ğŸ¯",-1)),t("div",_,[t("h3",null,r(d.stats.totalSkills),1),s[7]||(s[7]=t("p",null,"æŠ€èƒ½ç±»å‹",-1))])]),t("div",{class:"stat-card",onClick:s[2]||(s[2]=(...l)=>o.scrollToGrades&&o.scrollToGrades(...l))},[s[10]||(s[10]=t("div",{class:"stat-icon"},"ğŸ“ˆ",-1)),t("div",w,[t("h3",null,r(d.stats.totalGrades),1),s[9]||(s[9]=t("p",null,"å¹´çº§è¦†ç›–",-1))])]),t("div",{class:"stat-card",onClick:s[3]||(s[3]=(...l)=>o.scrollToErrors&&o.scrollToErrors(...l))},[s[12]||(s[12]=t("div",{class:"stat-icon"},"âš ï¸",-1)),t("div",E,[t("h3",null,r(d.stats.totalErrors),1),s[11]||(s[11]=t("p",null,"å¸¸è§é”™è¯¯",-1))])])]),t("div",C,[s[18]||(s[18]=t("h2",null,"ğŸ“‹ ç§‘ç›®è¯¦æƒ…",-1)),t("div",T,[(n(!0),i(u,null,h(d.subjects,l=>(n(),i("div",{key:l.key,class:"subject-card",onClick:c=>o.viewSubjectDetail(l)},[t("div",B,[t("span",I,r(l.icon),1),t("h3",null,r(l.name),1),t("span",{class:f(["subject-status",{active:l.isSupported}])},r(l.isSupported?"å·²å¯ç”¨":"æœªå¯ç”¨"),3)]),t("div",A,r(l.description),1),t("div",D,[t("div",F,[s[13]||(s[13]=t("span",{class:"stat-label"},"å¹´çº§èŒƒå›´:",-1)),t("span",V,r(l.grades.join("ã€"))+"å¹´çº§",1)]),t("div",x,[s[14]||(s[14]=t("span",{class:"stat-label"},"æŠ€èƒ½ç±»å‹:",-1)),t("span",N,r(l.skillCount)+"ç§",1)]),t("div",P,[s[15]||(s[15]=t("span",{class:"stat-label"},"å¸¸è§é”™è¯¯:",-1)),t("span",z,r(l.errorTypes)+"ç±»",1)])]),t("div",{class:"subject-skills",ref_for:!0,ref:"skillsSection"},[s[16]||(s[16]=t("h4",null,"ğŸ¯ æŠ€èƒ½ç±»å‹",-1)),t("div",L,[(n(!0),i(u,null,h(l.skillTypes,c=>(n(),i("span",{key:c,class:"skill-tag"},r(c),1))),128))])],512),t("div",{class:"subject-errors",ref_for:!0,ref:"errorsSection"},[s[17]||(s[17]=t("h4",null,"âš ï¸ å¸¸è§é”™è¯¯",-1)),t("div",J,[(n(!0),i(u,null,h(l.commonErrors,c=>(n(),i("span",{key:c,class:"error-tag"},r(c),1))),128))])],512)],8,G))),128))])],512),t("div",O,[s[19]||(s[19]=t("h2",null,"ğŸ“Š å¹´çº§åˆ†å¸ƒ",-1)),t("div",U,[(n(),i(u,null,h([1,2,3,4,5,6],l=>t("div",{key:l,class:"grade-bar"},[t("div",q,r(l)+"å¹´çº§",1),t("div",H,[(n(!0),i(u,null,h(o.getSubjectsForGrade(l),c=>(n(),i("span",{key:c.key,class:"grade-subject",style:j({backgroundColor:o.getSubjectColor(c.key)})},r(c.icon)+" "+r(c.name),5))),128))]),t("div",K,r(o.getSubjectsForGrade(l).length)+"é—¨",1)])),64))])],512),d.loading?(n(),i("div",M,s[20]||(s[20]=[t("div",{class:"spinner"},null,-1),t("p",null,"æ­£åœ¨åŠ è½½ç§‘ç›®ä¿¡æ¯...",-1)]))):g("",!0),d.error?(n(),i("div",Q,[t("p",null,"âŒ "+r(d.error),1),t("button",{onClick:s[4]||(s[4]=(...l)=>o.loadSubjects&&o.loadSubjects(...l)),class:"retry-btn"},"é‡è¯•")])):g("",!0)])}const X=v(k,[["render",R],["__scopeId","data-v-576a16fd"]]);export{X as default};
