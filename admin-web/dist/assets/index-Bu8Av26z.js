import{_ as v,c as r,a as s,d as u,t as i,h as _,F as h,r as g,n as P,b as c,o as n}from"./index-Dk_8qRP-.js";const m={name:"Users",data(){return{loading:!1,users:[],stats:{total:0,todayNew:0,activeUsers:0},currentPage:1,pageSize:10,totalPages:1}},mounted(){this.loadData()},methods:{async loadData(){this.loading=!0;try{await Promise.all([this.loadUsers(),this.loadStats()])}catch(t){console.error("åŠ è½½æ•°æ®å¤±è´¥:",t)}finally{this.loading=!1}},async loadUsers(){try{const t={page:this.currentPage,limit:this.pageSize},a=await c.users.getList(t);this.users=a.data||[],this.totalPages=Math.ceil((a.total||0)/this.pageSize)}catch(t){console.error("åŠ è½½ç”¨æˆ·åˆ—è¡¨å¤±è´¥:",t),this.users=[]}},async loadStats(){try{const t=await c.users.getStats();this.stats=t||{}}catch(t){console.error("åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥:",t)}},async loadPrevPage(){this.currentPage>1&&(this.currentPage--,await this.loadUsers())},async loadNextPage(){this.currentPage<this.totalPages&&(this.currentPage++,await this.loadUsers())},async deleteUser(t){if(confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªç”¨æˆ·å—ï¼Ÿ"))try{await c.users.delete(t),alert("ç”¨æˆ·åˆ é™¤æˆåŠŸï¼"),await this.loadData()}catch(a){alert("åˆ é™¤ç”¨æˆ·å¤±è´¥ï¼š"+a.message)}},viewUser(t){alert("æŸ¥çœ‹ç”¨æˆ·è¯¦æƒ…åŠŸèƒ½å¾…å®ç°ï¼š"+t.nickname)},async testUserAPI(){try{const t=await c.users.getStats();alert("ç”¨æˆ·APIæµ‹è¯•æˆåŠŸï¼"),console.log("APIæµ‹è¯•ç»“æœ:",t)}catch(t){alert("ç”¨æˆ·APIæµ‹è¯•å¤±è´¥ï¼"),console.error("APIæµ‹è¯•å¤±è´¥:",t)}},getAvatarText(t){return t?t.charAt(0).toUpperCase():"?"},formatDate(t){return t?new Date(t).toLocaleDateString("zh-CN"):"æœªçŸ¥"}}},y={class:"users"},b={class:"toolbar"},f={class:"stats-summary"},p={class:"stat-item"},k={class:"stat-value"},U={class:"stat-item"},w={class:"stat-value"},A={class:"stat-item"},C={class:"stat-value"},D={class:"user-list"},N={key:0,class:"loading"},x={key:1,class:"empty"},I={key:2},S={class:"col-name"},z={class:"user-info"},B={class:"user-avatar"},L={class:"user-details"},V={class:"col-status"},F={class:"col-date"},T={class:"col-actions"},E=["onClick"],M=["onClick"],j={key:0,class:"pagination"},q=["disabled"],G=["disabled"];function H(t,a,J,K,l,o){return n(),r("div",y,[a[8]||(a[8]=s("h2",null,"ğŸ‘¥ ç”¨æˆ·ç®¡ç†",-1)),s("div",b,[s("button",{class:"btn-secondary",onClick:a[0]||(a[0]=(...e)=>o.testUserAPI&&o.testUserAPI(...e))}," ğŸ”§ æµ‹è¯•API "),s("button",{class:"btn-secondary",onClick:a[1]||(a[1]=(...e)=>o.loadData&&o.loadData(...e))}," ğŸ”„ åˆ·æ–°æ•°æ® ")]),s("div",f,[s("div",p,[a[4]||(a[4]=s("span",{class:"stat-label"},"ç”¨æˆ·æ€»æ•°:",-1)),s("span",k,i(l.stats.total||0),1)]),s("div",U,[a[5]||(a[5]=s("span",{class:"stat-label"},"ä»Šæ—¥æ–°å¢:",-1)),s("span",w,i(l.stats.todayNew||0),1)]),s("div",A,[a[6]||(a[6]=s("span",{class:"stat-label"},"æ´»è·ƒç”¨æˆ·:",-1)),s("span",C,i(l.stats.activeUsers||0),1)])]),s("div",D,[l.loading?(n(),r("div",N,"åŠ è½½ä¸­...")):l.users.length===0?(n(),r("div",x," æš‚æ— ç”¨æˆ·æ•°æ® ")):(n(),r("div",I,[a[7]||(a[7]=_('<div class="list-header" data-v-500970a4><div class="col-name" data-v-500970a4>ç”¨æˆ·ä¿¡æ¯</div><div class="col-status" data-v-500970a4>çŠ¶æ€</div><div class="col-date" data-v-500970a4>æ³¨å†Œæ—¶é—´</div><div class="col-actions" data-v-500970a4>æ“ä½œ</div></div>',1)),(n(!0),r(h,null,g(l.users,e=>(n(),r("div",{key:e._id,class:"user-item"},[s("div",S,[s("div",z,[s("div",B,i(o.getAvatarText(e.nickname)),1),s("div",L,[s("h4",null,i(e.nickname||"æœªè®¾ç½®"),1),s("p",null,i(e.openid||"N/A"),1)])])]),s("div",V,[s("span",{class:P(["status-badge",e.active?"active":"inactive"])},i(e.active?"æ´»è·ƒ":"éæ´»è·ƒ"),3)]),s("div",F,i(o.formatDate(e.createdAt)),1),s("div",T,[s("button",{onClick:d=>o.viewUser(e),class:"btn-view"},"æŸ¥çœ‹",8,E),s("button",{onClick:d=>o.deleteUser(e._id),class:"btn-delete"},"åˆ é™¤",8,M)])]))),128))]))]),l.users.length>0?(n(),r("div",j,[s("button",{onClick:a[2]||(a[2]=(...e)=>o.loadPrevPage&&o.loadPrevPage(...e)),disabled:l.currentPage<=1},"ä¸Šä¸€é¡µ",8,q),s("span",null,"ç¬¬ "+i(l.currentPage)+" é¡µ / å…± "+i(l.totalPages)+" é¡µ",1),s("button",{onClick:a[3]||(a[3]=(...e)=>o.loadNextPage&&o.loadNextPage(...e)),disabled:l.currentPage>=l.totalPages},"ä¸‹ä¸€é¡µ",8,G)])):u("",!0)])}const Q=v(m,[["render",H],["__scopeId","data-v-500970a4"]]);export{Q as default};
