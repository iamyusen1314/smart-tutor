import{_ as u,c as r,a as s,t as i,F as d,r as m,i as _,h,n as v,b as n,o as l}from"./index-Dk_8qRP-.js";const g={name:"Analytics",data(){return{loading:!1,metrics:{totalReports:0,monthlyReports:0,avgStudyTime:"0分钟",studyTimeChange:"+0%",avgAccuracy:"0%",accuracyChange:"+0%",dailyActiveUsers:0,yesterdayActiveUsers:0},subjectStats:[{name:"math",displayName:"数学",count:0,percentage:0,avgScore:0},{name:"chinese",displayName:"语文",count:0,percentage:0,avgScore:0},{name:"english",displayName:"英语",count:0,percentage:0,avgScore:0}],recentReports:[],gameStats:{activePets:0,completedTasks:0,avgLevel:0}}},mounted(){this.loadData()},methods:{async loadData(){this.loading=!0;try{await Promise.all([this.loadReports(),this.loadStatistics(),this.loadGameStats()])}catch(e){console.error("加载数据失败:",e)}finally{this.loading=!1}},async loadReports(){try{const e=await n.analytics.getReports({limit:10});this.recentReports=e.data||[],this.metrics.totalReports=e.total||0}catch(e){console.error("加载报告数据失败:",e),this.recentReports=[]}},async loadStatistics(){try{const e=await n.analytics.getStatistics();this.metrics={...this.metrics,...e}}catch(e){console.error("加载统计数据失败:",e)}},async loadGameStats(){try{this.gameStats={activePets:Math.floor(Math.random()*100)+50,completedTasks:Math.floor(Math.random()*500)+200,avgLevel:Math.floor(Math.random()*10)+5}}catch(e){console.error("加载游戏化数据失败:",e)}},viewReport(e){alert("查看报告详情功能待实现："+e._id)},async testAnalyticsAPI(){try{const e=await n.analytics.getStatistics();alert("数据分析API测试成功！"),console.log("API测试结果:",e)}catch(e){alert("数据分析API测试失败！"),console.error("API测试失败:",e)}},getAvatarText(e){return e?e.charAt(0).toUpperCase():"?"},getSubjectName(e){return{math:"数学",chinese:"语文",english:"英语"}[e]||e},getScoreClass(e){return e>=90?"excellent":e>=80?"good":e>=60?"fair":"poor"},formatDate(e){return e?new Date(e).toLocaleString("zh-CN"):"未知"}}},p={class:"analytics"},y={class:"toolbar"},b={class:"metrics-grid"},f={class:"metric-card"},S={class:"metric-info"},A={class:"metric-number"},R={class:"metric-trend"},k={class:"metric-card"},j={class:"metric-info"},C={class:"metric-number"},P={class:"metric-trend"},N={class:"metric-card"},w={class:"metric-info"},I={class:"metric-number"},T={class:"metric-trend"},D={class:"metric-card"},x={class:"metric-info"},M={class:"metric-number"},L={class:"metric-trend"},U={class:"subject-analysis"},z={class:"subject-grid"},B={class:"subject-header"},F={class:"subject-name"},G={class:"subject-percentage"},V={class:"progress-bar"},E={class:"subject-details"},q={class:"recent-reports"},H={class:"reports-list"},J={key:0,class:"loading"},K={key:1,class:"empty"},O={key:2},Q={class:"col-user"},W={class:"user-info"},X={class:"user-avatar"},Y={class:"col-subject"},Z={class:"col-score"},$={class:"col-time"},ss={class:"col-actions"},ts=["onClick"],es={class:"game-stats"},as={class:"game-metrics"},is={class:"game-metric"},cs={class:"metric-value"},os={class:"game-metric"},rs={class:"metric-value"},ls={class:"game-metric"},ns={class:"metric-value"};function ds(e,t,ms,vs,c,o){return l(),r("div",p,[t[17]||(t[17]=s("h2",null,"📊 数据分析",-1)),s("div",y,[s("button",{class:"btn-secondary",onClick:t[0]||(t[0]=(...a)=>o.testAnalyticsAPI&&o.testAnalyticsAPI(...a))}," 🔧 测试API "),s("button",{class:"btn-secondary",onClick:t[1]||(t[1]=(...a)=>o.loadData&&o.loadData(...a))}," 🔄 刷新数据 ")]),s("div",b,[s("div",f,[t[3]||(t[3]=s("div",{class:"metric-icon"},"📈",-1)),s("div",S,[t[2]||(t[2]=s("h3",null,"学习报告总数",-1)),s("p",A,i(c.metrics.totalReports||0),1),s("span",R,"本月新增: "+i(c.metrics.monthlyReports||0),1)])]),s("div",k,[t[5]||(t[5]=s("div",{class:"metric-icon"},"⏱️",-1)),s("div",j,[t[4]||(t[4]=s("h3",null,"平均学习时长",-1)),s("p",C,i(c.metrics.avgStudyTime||"0分钟"),1),s("span",P,"较上月: "+i(c.metrics.studyTimeChange||"+0%"),1)])]),s("div",N,[t[7]||(t[7]=s("div",{class:"metric-icon"},"🎯",-1)),s("div",w,[t[6]||(t[6]=s("h3",null,"平均正确率",-1)),s("p",I,i(c.metrics.avgAccuracy||"0%"),1),s("span",T,"较上月: "+i(c.metrics.accuracyChange||"+0%"),1)])]),s("div",D,[t[9]||(t[9]=s("div",{class:"metric-icon"},"📱",-1)),s("div",x,[t[8]||(t[8]=s("h3",null,"今日活跃用户",-1)),s("p",M,i(c.metrics.dailyActiveUsers||0),1),s("span",L,"昨日: "+i(c.metrics.yesterdayActiveUsers||0),1)])])]),s("div",U,[t[10]||(t[10]=s("h3",null,"学科练习分析",-1)),s("div",z,[(l(!0),r(d,null,m(c.subjectStats,a=>(l(),r("div",{key:a.name,class:"subject-card"},[s("div",B,[s("span",F,i(a.displayName),1),s("span",G,i(a.percentage)+"%",1)]),s("div",V,[s("div",{class:"progress-fill",style:_({width:a.percentage+"%"})},null,4)]),s("div",E,[s("span",null,"练习次数: "+i(a.count),1),s("span",null,"平均分: "+i(a.avgScore)+"分",1)])]))),128))])]),s("div",q,[t[12]||(t[12]=s("h3",null,"最近学习报告",-1)),s("div",H,[c.loading?(l(),r("div",J,"加载中...")):c.recentReports.length===0?(l(),r("div",K," 暂无报告数据 ")):(l(),r("div",O,[t[11]||(t[11]=h('<div class="reports-header" data-v-e3607cb8><div class="col-user" data-v-e3607cb8>用户</div><div class="col-subject" data-v-e3607cb8>科目</div><div class="col-score" data-v-e3607cb8>得分</div><div class="col-time" data-v-e3607cb8>时间</div><div class="col-actions" data-v-e3607cb8>操作</div></div>',1)),(l(!0),r(d,null,m(c.recentReports,a=>(l(),r("div",{key:a._id,class:"report-item"},[s("div",Q,[s("div",W,[s("div",X,i(o.getAvatarText(a.userName)),1),s("span",null,i(a.userName||"匿名用户"),1)])]),s("div",Y,[s("span",{class:v(["subject-badge","subject-"+a.subject])},i(o.getSubjectName(a.subject)),3)]),s("div",Z,[s("span",{class:v(["score",o.getScoreClass(a.score)])},i(a.score||0)+"分 ",3)]),s("div",$,i(o.formatDate(a.createdAt)),1),s("div",ss,[s("button",{onClick:us=>o.viewReport(a),class:"btn-view"},"查看",8,ts)])]))),128))]))])]),s("div",es,[t[16]||(t[16]=s("h3",null,"游戏化系统数据",-1)),s("div",as,[s("div",is,[t[13]||(t[13]=s("span",{class:"metric-label"},"活跃宠物数量:",-1)),s("span",cs,i(c.gameStats.activePets||0),1)]),s("div",os,[t[14]||(t[14]=s("span",{class:"metric-label"},"完成任务总数:",-1)),s("span",rs,i(c.gameStats.completedTasks||0),1)]),s("div",ls,[t[15]||(t[15]=s("span",{class:"metric-label"},"平均等级:",-1)),s("span",ns,i(c.gameStats.avgLevel||0),1)])])])])}const hs=u(g,[["render",ds],["__scopeId","data-v-e3607cb8"]]);export{hs as default};
