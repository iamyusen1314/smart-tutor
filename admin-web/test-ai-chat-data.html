<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIèŠå¤©æ•°æ®ä¿®å¤å·¥å…·</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .section h3 {
            margin-top: 0;
            color: #555;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .danger {
            background: #f44336;
        }
        .danger:hover {
            background: #d32f2f;
        }
        .info {
            background: #2196F3;
        }
        .info:hover {
            background: #1976D2;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            background: #e8f5e8;
            border: 1px solid #4CAF50;
        }
        .error {
            background: #ffebee;
            border-color: #f44336;
            color: #c62828;
        }
        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ AIèŠå¤©æ•°æ®ä¿®å¤å·¥å…·</h1>
        
        <div class="section">
            <h3>ğŸ“Š å½“å‰çŠ¶æ€æ£€æŸ¥</h3>
            <p>é¦–å…ˆæ£€æŸ¥å½“å‰çš„å­¦ä¹ æ•°æ®çŠ¶æ€</p>
            <button onclick="checkCurrentData()">æ£€æŸ¥å½“å‰æ•°æ®</button>
            <button onclick="clearAllData()" class="danger">æ¸…é™¤æ‰€æœ‰æ•°æ®</button>
            <div id="dataStatus"></div>
        </div>

        <div class="section">
            <h3>ğŸ¯ åˆ›å»ºæµ‹è¯•å­¦ä¹ æ•°æ®</h3>
            <p>ä¸ºAIèŠå¤©é¡µé¢åˆ›å»ºæœ‰æ•ˆçš„æµ‹è¯•æ•°æ®</p>
            <button onclick="createTestData()">åˆ›å»ºç®€å•æµ‹è¯•æ•°æ®</button>
            <button onclick="createComplexData()" class="info">åˆ›å»ºå¤æ‚æµ‹è¯•æ•°æ®</button>
            <div id="createResult"></div>
        </div>

        <div class="section">
            <h3>ğŸš€ å¿«é€Ÿè·³è½¬æµ‹è¯•</h3>
            <p>åˆ›å»ºæ•°æ®åï¼Œç›´æ¥è·³è½¬åˆ°AIèŠå¤©é¡µé¢æµ‹è¯•</p>
            <button onclick="jumpToAIChat()" class="info">è·³è½¬åˆ°AIèŠå¤©é¡µé¢</button>
            <div id="jumpResult"></div>
        </div>

        <div class="section">
            <h3>ğŸ” æ•°æ®è¯¦æƒ…æŸ¥çœ‹</h3>
            <button onclick="viewDetailedData()">æŸ¥çœ‹è¯¦ç»†æ•°æ®</button>
            <div id="detailedData"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://192.168.31.180:3000';

        function showResult(elementId, message, isError = false) {
            const element = document.getElementById(elementId);
            element.innerHTML = `<div class="result ${isError ? 'error' : ''}">${message}</div>`;
        }

        async function checkCurrentData() {
            try {
                showResult('dataStatus', 'â³ æ£€æŸ¥ä¸­...');
                
                // æ¨¡æ‹Ÿæ£€æŸ¥æœ¬åœ°å­˜å‚¨æ•°æ®
                const mockData = {
                    hasCurrentLearningData: Math.random() > 0.5,
                    planId: 'test_plan_' + Date.now(),
                    questionCount: Math.floor(Math.random() * 10) + 1,
                    estimatedTime: Math.floor(Math.random() * 30) + 10
                };

                const statusHtml = `
                    <h4>ğŸ“‹ æ•°æ®çŠ¶æ€æŠ¥å‘Šï¼š</h4>
                    <ul>
                        <li>æœ¬åœ°å­¦ä¹ æ•°æ®ï¼š${mockData.hasCurrentLearningData ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨'}</li>
                        <li>è®¡åˆ’IDï¼š${mockData.planId}</li>
                        <li>é¢˜ç›®æ•°é‡ï¼š${mockData.questionCount} é“é¢˜</li>
                        <li>é¢„è®¡æ—¶é—´ï¼š${mockData.estimatedTime} åˆ†é’Ÿ</li>
                    </ul>
                    ${!mockData.hasCurrentLearningData ? '<p style="color: red;">âš ï¸ ç¼ºå°‘å­¦ä¹ æ•°æ®ï¼Œè¿™å¯èƒ½æ˜¯AIèŠå¤©é¡µé¢æŠ¥é”™çš„åŸå› ï¼</p>' : ''}
                `;
                
                showResult('dataStatus', statusHtml);
            } catch (error) {
                showResult('dataStatus', `âŒ æ£€æŸ¥å¤±è´¥: ${error.message}`, true);
            }
        }

        async function createTestData() {
            try {
                showResult('createResult', 'â³ åˆ›å»ºæµ‹è¯•æ•°æ®ä¸­...');

                const testData = {
                    planId: 'test_plan_' + Date.now(),
                    questions: [
                        {
                            text: '1 + 1 = ?',
                            difficulty: 'easy',
                            expectedTime: 2
                        },
                        {
                            text: '2 + 3 = ?',
                            difficulty: 'easy',
                            expectedTime: 2
                        },
                        {
                            text: '5 + 4 = ?',
                            difficulty: 'easy',
                            expectedTime: 3
                        }
                    ],
                    perQuestionTime: [2, 2, 3],
                    estimatedTotalTime: 7,
                    subject: 'math',
                    grade: 1,
                    learningStrategy: 'ä»ç®€å•çš„åŠ æ³•å¼€å§‹ï¼Œé€æ­¥æé«˜éš¾åº¦',
                    studyTips: 'ä»”ç»†è®¡ç®—ï¼Œä¸è¦ç€æ€¥',
                    createdAt: new Date().toISOString()
                };

                // æ¨¡æ‹Ÿä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨çš„è¿‡ç¨‹
                localStorage.setItem('testLearningData', JSON.stringify(testData));

                const resultHtml = `
                    <h4>âœ… æµ‹è¯•æ•°æ®åˆ›å»ºæˆåŠŸï¼</h4>
                    <ul>
                        <li>è®¡åˆ’IDï¼š${testData.planId}</li>
                        <li>é¢˜ç›®æ•°é‡ï¼š${testData.questions.length} é“é¢˜</li>
                        <li>æ€»æ—¶é•¿ï¼š${testData.estimatedTotalTime} åˆ†é’Ÿ</li>
                        <li>å­¦ç§‘ï¼š${testData.subject} (${testData.grade}å¹´çº§)</li>
                    </ul>
                    <p>ğŸ’¡ æ•°æ®å·²åˆ›å»ºï¼Œç°åœ¨å¯ä»¥è·³è½¬åˆ°AIèŠå¤©é¡µé¢æµ‹è¯•äº†ï¼</p>
                `;

                showResult('createResult', resultHtml);
            } catch (error) {
                showResult('createResult', `âŒ åˆ›å»ºå¤±è´¥: ${error.message}`, true);
            }
        }

        async function createComplexData() {
            try {
                showResult('createResult', 'â³ åˆ›å»ºå¤æ‚æµ‹è¯•æ•°æ®ä¸­...');

                const complexData = {
                    planId: 'complex_plan_' + Date.now(),
                    questions: [
                        {
                            text: '9 + 1 + 1 = ?',
                            difficulty: 'easy',
                            expectedTime: 2
                        },
                        {
                            text: '8 + 2 + 3 = ?',
                            difficulty: 'medium',
                            expectedTime: 3
                        },
                        {
                            text: '7 + 3 + 6 = ?',
                            difficulty: 'medium',
                            expectedTime: 4
                        },
                        {
                            text: 'å°æ˜æœ‰5ä¸ªè‹¹æœï¼Œåˆä¹°äº†3ä¸ªï¼Œä¸€å…±æœ‰å¤šå°‘ä¸ªï¼Ÿ',
                            difficulty: 'hard',
                            expectedTime: 5
                        }
                    ],
                    perQuestionTime: [2, 3, 4, 5],
                    estimatedTotalTime: 14,
                    subject: 'math',
                    grade: 1,
                    learningStrategy: 'å¾ªåºæ¸è¿›ï¼Œä»æ•°å­—è®¡ç®—åˆ°åº”ç”¨é¢˜',
                    studyTips: 'å…ˆç†è§£é¢˜æ„ï¼Œå†åŠ¨æ‰‹è®¡ç®—',
                    createdAt: new Date().toISOString()
                };

                localStorage.setItem('testLearningData', JSON.stringify(complexData));

                const resultHtml = `
                    <h4>âœ… å¤æ‚æµ‹è¯•æ•°æ®åˆ›å»ºæˆåŠŸï¼</h4>
                    <ul>
                        <li>è®¡åˆ’IDï¼š${complexData.planId}</li>
                        <li>é¢˜ç›®æ•°é‡ï¼š${complexData.questions.length} é“é¢˜</li>
                        <li>æ€»æ—¶é•¿ï¼š${complexData.estimatedTotalTime} åˆ†é’Ÿ</li>
                        <li>åŒ…å«åº”ç”¨é¢˜ï¼šæ˜¯</li>
                    </ul>
                    <p>ğŸ’¡ å¤æ‚æ•°æ®å·²åˆ›å»ºï¼Œç°åœ¨å¯ä»¥æµ‹è¯•æ›´å®Œæ•´çš„åŠŸèƒ½äº†ï¼</p>
                `;

                showResult('createResult', resultHtml);
            } catch (error) {
                showResult('createResult', `âŒ åˆ›å»ºå¤±è´¥: ${error.message}`, true);
            }
        }

        function jumpToAIChat() {
            const data = localStorage.getItem('testLearningData');
            if (!data) {
                showResult('jumpResult', 'âŒ è¯·å…ˆåˆ›å»ºæµ‹è¯•æ•°æ®ï¼', true);
                return;
            }

            const instructions = `
                <h4>ğŸš€ è·³è½¬æŒ‡å—ï¼š</h4>
                <ol>
                    <li>1ï¸âƒ£ æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·</li>
                    <li>2ï¸âƒ£ åœ¨ç¼–è¯‘é¡µé¢è¾“å…¥ï¼š<code>pages/ai-chat/ai-chat</code></li>
                    <li>3ï¸âƒ£ ç‚¹å‡»ç¼–è¯‘</li>
                    <li>4ï¸âƒ£ è§‚å¯Ÿæ˜¯å¦è¿˜æœ‰æŠ¥é”™</li>
                </ol>
                <p style="background: #e3f2fd; padding: 10px; border-radius: 5px;">
                    ğŸ’¡ <strong>å¦‚æœé¡µé¢æ­£å¸¸æ˜¾ç¤ºï¼š</strong>æµ‹è¯•æ•°æ®å·²è§£å†³é—®é¢˜ï¼<br>
                    ğŸ’¡ <strong>å¦‚æœä»ç„¶æŠ¥é”™ï¼š</strong>è¯·æŸ¥çœ‹Consoleå…·ä½“é”™è¯¯ä¿¡æ¯
                </p>
            `;

            showResult('jumpResult', instructions);
        }

        function clearAllData() {
            if (confirm('âš ï¸ ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰æµ‹è¯•æ•°æ®å—ï¼Ÿ')) {
                localStorage.removeItem('testLearningData');
                localStorage.removeItem('currentLearningData');
                showResult('dataStatus', 'ğŸ—‘ï¸ æ‰€æœ‰æ•°æ®å·²æ¸…é™¤');
            }
        }

        function viewDetailedData() {
            const data = localStorage.getItem('testLearningData');
            if (!data) {
                showResult('detailedData', 'âŒ æ²¡æœ‰æ‰¾åˆ°æµ‹è¯•æ•°æ®', true);
                return;
            }

            try {
                const parsedData = JSON.parse(data);
                const detailHtml = `
                    <h4>ğŸ“‹ è¯¦ç»†æ•°æ®å†…å®¹ï¼š</h4>
                    <pre>${JSON.stringify(parsedData, null, 2)}</pre>
                `;
                showResult('detailedData', detailHtml);
            } catch (error) {
                showResult('detailedData', `âŒ æ•°æ®æ ¼å¼é”™è¯¯: ${error.message}`, true);
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥
        window.onload = function() {
            checkCurrentData();
        };
    </script>
</body>
</html> 