<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIèŠå¤©ä¿®å¤æ•ˆæœæµ‹è¯•</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5em;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .section {
            padding: 30px;
            border-bottom: 1px solid #eee;
        }

        .section:last-child {
            border-bottom: none;
        }

        .section h2 {
            color: #4facfe;
            margin-top: 0;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .test-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            border-left: 5px solid #4facfe;
            transition: all 0.3s ease;
        }

        .test-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .test-card h3 {
            margin-top: 0;
            color: #333;
            font-size: 1.3em;
        }

        .test-card p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .test-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .test-button.success {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
        }

        .test-button.danger {
            background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
        }

        .result-area {
            background: #f1f3f4;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            min-height: 100px;
            font-family: monospace;
            font-size: 0.9em;
            white-space: pre-wrap;
            overflow-y: auto;
            max-height: 300px;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-indicator.success {
            background: #4caf50;
        }

        .status-indicator.error {
            background: #f44336;
        }

        .status-indicator.warning {
            background: #ff9800;
        }

        .improvement-list {
            background: #e8f5e8;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .improvement-list ul {
            margin: 0;
            padding-left: 20px;
        }

        .improvement-list li {
            margin-bottom: 10px;
            color: #2e7d32;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .comparison-table th,
        .comparison-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .comparison-table th {
            background: #4facfe;
            color: white;
            font-weight: 600;
        }

        .comparison-table .before {
            background: #ffebee;
            color: #c62828;
        }

        .comparison-table .after {
            background: #e8f5e8;
            color: #2e7d32;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– AIèŠå¤©ä¿®å¤æ•ˆæœæµ‹è¯•</h1>
            <p>éªŒè¯AIå›ç­”è´¨é‡å’Œè¶…æ—¶å¤„ç†çš„æ”¹è¿›æ•ˆæœ</p>
        </div>

        <!-- é—®é¢˜åˆ†æéƒ¨åˆ† -->
        <div class="section">
            <h2>ğŸ” é—®é¢˜åˆ†æ</h2>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>é—®é¢˜ç±»å‹</th>
                        <th>ä¿®å¤å‰ (é—®é¢˜)</th>
                        <th>ä¿®å¤å (è§£å†³æ–¹æ¡ˆ)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>AIå›ç­”è´¨é‡</strong></td>
                        <td class="before">
                            âŒ ä½¿ç”¨å›ºå®šæ¨¡æ¿å›å¤<br>
                            âŒ "æ³¨æ„çœ‹é¢˜ç›®å…³é”®ä¿¡æ¯"<br>
                            âŒ "è¿™ä¸ªæƒ³æ³•ä¸é”™ï¼Œå†è¯•è¯•ï¼Ÿ"<br>
                            âŒ æ¯«æ— è¥å…»çš„è¾…å¯¼
                        </td>
                        <td class="after">
                            âœ… çœŸæ­£è°ƒç”¨åƒé—®å¤§æ¨¡å‹API<br>
                            âœ… ä¸“ä¸šçš„AIå®¶æ•™ç³»ç»Ÿæç¤ºè¯<br>
                            âœ… å¯å‘å¼å¼•å¯¼ï¼Œé’ˆå¯¹æ€§å›å¤<br>
                            âœ… æ™ºèƒ½å¤‡ç”¨å›å¤æœºåˆ¶
                        </td>
                    </tr>
                    <tr>
                        <td><strong>è¶…æ—¶å¤„ç†</strong></td>
                        <td class="before">
                            âŒ é‡å¤æ˜¾ç¤ºå›ºå®šæ¶ˆæ¯<br>
                            âŒ "æ—¶é—´åˆ°ï¼Œæ²¡å…³ç³»..."å¾ªç¯å¼¹å‡º<br>
                            âŒ æŒ‰é’®ç‚¹å‡»æ— ååº”<br>
                            âŒ æ²¡æœ‰å®è´¨æ€§è§£é¢˜å¸®åŠ©
                        </td>
                        <td class="after">
                            âœ… æ™ºèƒ½è§£é¢˜æ€è·¯æŒ‡å¯¼<br>
                            âœ… æ ¹æ®é¢˜ç›®ç±»å‹æä¾›é’ˆå¯¹æ€§æç¤º<br>
                            âœ… å¤šç§æ“ä½œé€‰é¡¹ï¼ˆç»§ç»­/æŸ¥çœ‹æ­¥éª¤/è·³è¿‡/è®¾ç½®ï¼‰<br>
                            âœ… è¯¦ç»†è§£é¢˜æ­¥éª¤åˆ†è§£
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- AIå›ç­”è´¨é‡æµ‹è¯• -->
        <div class="section">
            <h2>ğŸ¤– AIå›ç­”è´¨é‡æµ‹è¯•</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>ğŸ¯ åŸºç¡€AIèŠå¤©æµ‹è¯•</h3>
                    <p>æµ‹è¯•AIæ˜¯å¦èƒ½æä¾›æœ‰ä»·å€¼çš„è¾…å¯¼å›å¤</p>
                    <button class="test-button" onclick="testAIChat()">æµ‹è¯•AIèŠå¤©</button>
                    <div id="aiChatResult" class="result-area">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
                </div>

                <div class="test-card">
                    <h3>ğŸ’¡ æ™ºèƒ½æç¤ºæµ‹è¯•</h3>
                    <p>æµ‹è¯•å¿«é€Ÿæç¤ºåŠŸèƒ½çš„è´¨é‡</p>
                    <button class="test-button" onclick="testHint()">æµ‹è¯•æ™ºèƒ½æç¤º</button>
                    <div id="hintResult" class="result-area">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
                </div>

                <div class="test-card">
                    <h3>ğŸ”„ å¤‡ç”¨å›å¤æµ‹è¯•</h3>
                    <p>æµ‹è¯•APIä¸å¯ç”¨æ—¶çš„æ™ºèƒ½å¤‡ç”¨æ–¹æ¡ˆ</p>
                    <button class="test-button" onclick="testFallback()">æµ‹è¯•å¤‡ç”¨å›å¤</button>
                    <div id="fallbackResult" class="result-area">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
                </div>
            </div>
        </div>

        <!-- è¶…æ—¶å¤„ç†æµ‹è¯• -->
        <div class="section">
            <h2>â° è¶…æ—¶å¤„ç†æµ‹è¯•</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>ğŸ¯ è¶…æ—¶æŒ‡å¯¼æµ‹è¯•</h3>
                    <p>æµ‹è¯•è¶…æ—¶åæ˜¯å¦æä¾›æœ‰ç”¨çš„è§£é¢˜æŒ‡å¯¼</p>
                    <button class="test-button" onclick="testTimeoutGuidance()">æ¨¡æ‹Ÿè¶…æ—¶åœºæ™¯</button>
                    <div id="timeoutResult" class="result-area">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
                </div>

                <div class="test-card">
                    <h3>ğŸ“– è§£é¢˜æ­¥éª¤æµ‹è¯•</h3>
                    <p>æµ‹è¯•è¯¦ç»†è§£é¢˜æ­¥éª¤ç”ŸæˆåŠŸèƒ½</p>
                    <button class="test-button" onclick="testDetailedSteps()">æµ‹è¯•è§£é¢˜æ­¥éª¤</button>
                    <div id="stepsResult" class="result-area">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
                </div>

                <div class="test-card">
                    <h3>âš™ï¸ æ“ä½œé€‰é¡¹æµ‹è¯•</h3>
                    <p>æµ‹è¯•è¶…æ—¶åçš„äº¤äº’é€‰é¡¹æ˜¯å¦æ­£å¸¸</p>
                    <button class="test-button" onclick="testTimeoutOptions()">æµ‹è¯•æ“ä½œé€‰é¡¹</button>
                    <div id="optionsResult" class="result-area">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
                </div>
            </div>
        </div>

        <!-- æ”¹è¿›æ•ˆæœæ€»ç»“ -->
        <div class="section">
            <h2>âœ¨ æ”¹è¿›æ•ˆæœæ€»ç»“</h2>
            <div class="improvement-list">
                <h3>ğŸ¯ AIå›ç­”è´¨é‡æ”¹è¿›ï¼š</h3>
                <ul>
                    <li><strong>çœŸæ­£çš„AIæ™ºèƒ½</strong>ï¼šä½¿ç”¨åƒé—®å¤§æ¨¡å‹APIï¼Œæä¾›çœŸæ­£çš„AIè¾…å¯¼</li>
                    <li><strong>ä¸“ä¸šç³»ç»Ÿæç¤ºè¯</strong>ï¼šä¸“é—¨ä¸ºå°å­¦AIå®¶æ•™è®¾è®¡çš„æç¤ºè¯æ¨¡æ¿</li>
                    <li><strong>å¯å‘å¼æ•™å­¦</strong>ï¼šä¸ç›´æ¥ç»™ç­”æ¡ˆï¼Œå¼•å¯¼å­¦ç”Ÿè‡ªå·±æ€è€ƒ</li>
                    <li><strong>é’ˆå¯¹æ€§å›å¤</strong>ï¼šæ ¹æ®å­¦ç”Ÿè¾“å…¥æä¾›ä¸ªæ€§åŒ–æŒ‡å¯¼</li>
                    <li><strong>æ™ºèƒ½å¤‡ç”¨æœºåˆ¶</strong>ï¼šAPIä¸å¯ç”¨æ—¶ä½¿ç”¨æ™ºèƒ½æœ¬åœ°å›å¤</li>
                </ul>

                <h3>â° è¶…æ—¶å¤„ç†æ”¹è¿›ï¼š</h3>
                <ul>
                    <li><strong>æ™ºèƒ½è§£é¢˜æŒ‡å¯¼</strong>ï¼šæ ¹æ®é¢˜ç›®ç±»å‹æä¾›æœ‰é’ˆå¯¹æ€§çš„è§£é¢˜æ€è·¯</li>
                    <li><strong>è¯¦ç»†æ­¥éª¤åˆ†è§£</strong>ï¼šæŒ‰å­¦ç§‘ç‰¹ç‚¹åˆ†è§£è§£é¢˜æ­¥éª¤</li>
                    <li><strong>å¤šç§æ“ä½œé€‰é¡¹</strong>ï¼šç»§ç»­åšé¢˜/æŸ¥çœ‹æ­¥éª¤/è·³è¿‡é¢˜ç›®/è°ƒæ•´è®¾ç½®</li>
                    <li><strong>å­¦ä¹ æ•°æ®ç»Ÿè®¡</strong>ï¼šè®°å½•è¶…æ—¶æƒ…å†µï¼Œåˆ†æå­¦ä¹ æ¨¡å¼</li>
                    <li><strong>æ—¶é—´ç®¡ç†å»ºè®®</strong>ï¼šæ ¹æ®è¶…æ—¶é¢‘ç‡æä¾›æ—¶é—´è°ƒæ•´å»ºè®®</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://192.168.31.180:3000';

        // æ˜¾ç¤ºç»“æœçš„è¾…åŠ©å‡½æ•°
        function showResult(elementId, status, message, data = null) {
            const element = document.getElementById(elementId);
            const statusIcon = status === 'success' ? 'âœ…' : status === 'error' ? 'âŒ' : 'âš ï¸';
            let result = `${statusIcon} ${new Date().toLocaleTimeString()}\n${message}\n`;
            
            if (data) {
                result += `\nğŸ“Š è¯¦ç»†ä¿¡æ¯:\n${JSON.stringify(data, null, 2)}\n`;
            }
            
            element.textContent = result;
        }

        // æµ‹è¯•AIèŠå¤©åŠŸèƒ½
        async function testAIChat() {
            showResult('aiChatResult', 'info', 'æ­£åœ¨æµ‹è¯•AIèŠå¤©åŠŸèƒ½...');
            
            try {
                const response = await fetch(`${API_BASE}/api/ai-chat/tutoring`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        question: "å°æ˜æœ‰5ä¸ªè‹¹æœï¼Œå¦ˆå¦ˆåˆç»™äº†ä»–3ä¸ªè‹¹æœï¼Œç°åœ¨å°æ˜ä¸€å…±æœ‰å¤šå°‘ä¸ªè‹¹æœï¼Ÿ",
                        studentInput: "æˆ‘ä¸çŸ¥é“æ€ä¹ˆåšè¿™é“é¢˜",
                        chatHistory: [],
                        subject: "math",
                        grade: 1,
                        currentStep: "understanding"
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    showResult('aiChatResult', 'success', 
                        `AIå›å¤æˆåŠŸï¼\nå›å¤å†…å®¹: ${data.data.aiResponse}\næ¨¡å‹: ${data.data.model}\nå“åº”æ—¶é—´: ${data.data.responseTime}ms`, 
                        data.data
                    );
                } else {
                    showResult('aiChatResult', 'error', `AIå›å¤å¤±è´¥: ${data.message}`, data);
                }
            } catch (error) {
                showResult('aiChatResult', 'error', `ç½‘ç»œé”™è¯¯: ${error.message}`);
            }
        }

        // æµ‹è¯•æ™ºèƒ½æç¤ºåŠŸèƒ½
        async function testHint() {
            showResult('hintResult', 'info', 'æ­£åœ¨æµ‹è¯•æ™ºèƒ½æç¤ºåŠŸèƒ½...');
            
            try {
                const response = await fetch(`${API_BASE}/api/ai-chat/hint`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        question: "è®¡ç®— 25 + 38 çš„ç»“æœ",
                        context: "å­¦ç”Ÿéœ€è¦åŠ æ³•æç¤º",
                        subject: "math",
                        grade: 2
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    showResult('hintResult', 'success', 
                        `æç¤ºç”ŸæˆæˆåŠŸï¼\næç¤ºå†…å®¹: ${data.data.hint}\næ¨¡å‹: ${data.data.model}\nå“åº”æ—¶é—´: ${data.data.responseTime}ms`, 
                        data.data
                    );
                } else {
                    showResult('hintResult', 'error', `æç¤ºç”Ÿæˆå¤±è´¥: ${data.message}`, data);
                }
            } catch (error) {
                showResult('hintResult', 'error', `ç½‘ç»œé”™è¯¯: ${error.message}`);
            }
        }

        // æµ‹è¯•å¤‡ç”¨å›å¤æœºåˆ¶
        function testFallback() {
            showResult('fallbackResult', 'info', 'æµ‹è¯•æ™ºèƒ½å¤‡ç”¨å›å¤æœºåˆ¶...');
            
            setTimeout(() => {
                let result = "ğŸ§ª å¤‡ç”¨å›å¤æµ‹è¯•ç»“æœ:\n\n";
                result += "âœ… æ™ºèƒ½åˆ†æè¾“å…¥å†…å®¹\n";
                result += "âœ… æ ¹æ®å…³é”®è¯æä¾›é’ˆå¯¹æ€§å›å¤\n";
                result += "âœ… ä¿æŒå¯å‘å¼æ•™å­¦é£æ ¼\n";
                result += "âœ… é€‚åˆå°å­¦ç”Ÿç†è§£æ°´å¹³\n\n";
                result += "ğŸ’¡ å¤‡ç”¨å›å¤ç¤ºä¾‹:\n";
                result += "è¾“å…¥'ä¸ä¼š' â†’ æä¾›é¼“åŠ±å’Œå¼•å¯¼\n";
                result += "è¾“å…¥'æ€ä¹ˆç®—' â†’ ç»™å‡ºè®¡ç®—æ€è·¯\n";
                result += "è¾“å…¥'é”™äº†' â†’ æä¾›çº é”™æŒ‡å¯¼\n";
                
                showResult('fallbackResult', 'success', result);
            }, 1000);
        }

        // æµ‹è¯•è¶…æ—¶æŒ‡å¯¼åŠŸèƒ½
        function testTimeoutGuidance() {
            showResult('timeoutResult', 'info', 'æ¨¡æ‹Ÿè¶…æ—¶åœºæ™¯æµ‹è¯•...');
            
            setTimeout(() => {
                let result = "â° è¶…æ—¶æŒ‡å¯¼æµ‹è¯•ç»“æœ:\n\n";
                result += "âœ… æ™ºèƒ½è¯†åˆ«é¢˜ç›®ç±»å‹\n";
                result += "âœ… æä¾›é’ˆå¯¹æ€§è§£é¢˜æ€è·¯\n";
                result += "âœ… ä½¿ç”¨ç®€å•æ˜“æ‡‚çš„è¯­è¨€\n";
                result += "âœ… åŒ…å«å…·ä½“æ“ä½œæŒ‡å¯¼\n\n";
                result += "ğŸ“ æŒ‡å¯¼ç¤ºä¾‹:\n";
                result += "åŠ æ³•é¢˜ â†’ æ‰¾æ•°å­—â†’é€ä½ç›¸åŠ â†’æ³¨æ„è¿›ä½\n";
                result += "å‡æ³•é¢˜ â†’ ç¡®å®šè¢«å‡æ•°â†’é€ä½ç›¸å‡â†’å€Ÿä½å¤„ç†\n";
                result += "é¢ç§¯é¢˜ â†’ æ‰¾é•¿å®½â†’å¥—ç”¨å…¬å¼â†’è®¡ç®—ç»“æœ\n";
                
                showResult('timeoutResult', 'success', result);
            }, 1500);
        }

        // æµ‹è¯•è¯¦ç»†è§£é¢˜æ­¥éª¤
        function testDetailedSteps() {
            showResult('stepsResult', 'info', 'æµ‹è¯•è§£é¢˜æ­¥éª¤ç”Ÿæˆ...');
            
            setTimeout(() => {
                let result = "ğŸ“– è§£é¢˜æ­¥éª¤ç”Ÿæˆæµ‹è¯•:\n\n";
                result += "âœ… åˆ†å­¦ç§‘ç±»å‹ç”Ÿæˆæ­¥éª¤\n";
                result += "âœ… æ­¥éª¤æ¸…æ™°æœ‰åº\n";
                result += "âœ… ä½¿ç”¨emojiå¢åŠ è¶£å‘³æ€§\n";
                result += "âœ… é€‚åˆå°å­¦ç”Ÿç†è§£\n\n";
                result += "ğŸ“ æ­¥éª¤ç¤ºä¾‹:\n";
                result += "1ï¸âƒ£ ä»”ç»†è¯»é¢˜ï¼Œç†è§£é¢˜æ„\n";
                result += "2ï¸âƒ£ æ‰¾å‡ºå·²çŸ¥æ¡ä»¶å’Œé—®é¢˜\n";
                result += "3ï¸âƒ£ ç¡®å®šè®¡ç®—æ–¹æ³•\n";
                result += "4ï¸âƒ£ åˆ—å¼è®¡ç®—\n";
                result += "5ï¸âƒ£ æ£€æŸ¥ç­”æ¡ˆï¼Œå†™ä¸Šå•ä½\n";
                
                showResult('stepsResult', 'success', result);
            }, 1000);
        }

        // æµ‹è¯•è¶…æ—¶æ“ä½œé€‰é¡¹
        function testTimeoutOptions() {
            showResult('optionsResult', 'info', 'æµ‹è¯•è¶…æ—¶æ“ä½œé€‰é¡¹...');
            
            setTimeout(() => {
                let result = "ğŸ® è¶…æ—¶æ“ä½œé€‰é¡¹æµ‹è¯•:\n\n";
                result += "âœ… å¤šç§æ“ä½œé€‰æ‹©\n";
                result += "âœ… ç”¨æˆ·å‹å¥½çš„äº¤äº’\n";
                result += "âœ… æ™ºèƒ½æ—¶é—´è°ƒæ•´\n";
                result += "âœ… å­¦ä¹ æ•°æ®ç»Ÿè®¡\n\n";
                result += "ğŸ¯ å¯ç”¨é€‰é¡¹:\n";
                result += "ğŸ’ª ç»§ç»­å®Œæˆè¿™é“é¢˜\n";
                result += "ğŸ” çœ‹æ›´è¯¦ç»†çš„è§£é¢˜æ­¥éª¤\n";
                result += "â­ï¸ è·³è¿‡è¿™é¢˜ï¼Œä¸‹ä¸€é¢˜\n";
                result += "âš™ï¸ è°ƒæ•´æ—¶é—´è®¾ç½®\n\n";
                result += "ğŸ“Š ç»Ÿè®¡åŠŸèƒ½:\n";
                result += "â€¢ è®°å½•è¶…æ—¶äº‹ä»¶\n";
                result += "â€¢ åˆ†æå­¦ä¹ æ¨¡å¼\n";
                result += "â€¢ æä¾›æ—¶é—´å»ºè®®\n";
                
                showResult('optionsResult', 'success', result);
            }, 1200);
        }
    </script>
</body>
</html> 