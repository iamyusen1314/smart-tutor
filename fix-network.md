# 🔧 小程序网络连接问题解决指南

## 问题描述
小程序提示：`request:fail timeout` 错误

## 解决步骤

### 1. 微信开发者工具设置 ⭐ **最重要**
1. 打开微信开发者工具
2. 点击右上角 **"详情"** 按钮
3. 选择 **"本地设置"** 选项卡
4. **勾选** "不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书"
5. **重启微信开发者工具**（必须！）

### 2. 验证后端服务器
在浏览器中打开：http://192.168.2.120:3000/health
如果显示类似 `{"status":"ok","timestamp":...}` 则服务器正常

### 3. 检查小程序配置
确认 `miniprogram/app.js` 中的 API 地址为：
```javascript
apiHost: 'http://192.168.2.120:3000'
```

### 4. 重启小程序
在微信开发者工具中：
- 点击 "编译" 按钮重新编译小程序
- 或者按 Ctrl+Shift+R 强制刷新

### 5. 如果仍然失败
1. 确认防火墙没有阻止端口 3000
2. 尝试使用 localhost 地址：修改 app.js 中的 apiHost 为 `http://localhost:3000`
3. 检查网络连接是否正常

## 验证方法
在小程序的主页面，应该显示 "✅ 连接正常" 而不是 "❌ 连接失败"

## 常见错误解决
- `request:fail timeout`: 检查上述步骤1-5
- `url not in domain list`: 确保勾选了 "不校验合法域名"
- `network error`: 检查服务器是否运行，防火墙设置

---
💡 **提示**: 开发环境中最常见的问题就是忘记勾选 "不校验合法域名" 选项！ 