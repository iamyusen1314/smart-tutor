# IP地址配置更新完成

## 📍 新IP地址配置

**旧IP地址**: `172.25.100.114`  
**新IP地址**: `192.168.33.116`  
**更新时间**: 2025-06-18

## ✅ 已更新的配置文件

### 1. 小程序主配置文件
- **文件**: `miniprogram/app.js`
- **更新内容**:
  ```javascript
  apiHost: 'http://192.168.33.116:3000',  // API服务器地址
  API_BASE_URL: 'http://192.168.33.116:3000/api',  // API基础URL
  ```

### 2. 服务器显示信息
- **文件**: `server/app.js`
- **更新内容**: 启动时显示的小程序访问地址、健康检查地址等

## 🚀 验证步骤

### 1. 后端服务验证
```bash
# 健康检查
curl http://192.168.33.116:3000/health

# 应该返回类似以下内容：
# {"status":"ok","timestamp":...,"version":"1.0.0",...}
```

### 2. 小程序连接验证
1. 打开微信开发者工具
2. 导入 `miniprogram` 目录
3. 确保开发工具设置中：
   - ✅ 勾选"不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书"
   - ✅ 勾选"不校验 Referer"
4. 编译运行小程序

### 3. 网络连接测试
在小程序调试控制台中应该看到：
```
📌 注意：自动IP检测已禁用，当前使用固定IP: http://192.168.33.116:3000
网络连接测试成功: {status: "ok", ...}
网络连接状态: 正常
```

## 🎯 小程序开发者工具配置要点

### 必要设置
1. **打开微信开发者工具**
2. **导入项目**: 选择 `miniprogram` 目录
3. **关键设置**:
   - 点击右上角"详情"
   - 在"本地设置"中：
     - ☑️ 不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书
     - ☑️ 不校验 Referer  
     - ☑️ 启用调试

### 验证连接
1. 点击"编译"按钮
2. 查看控制台输出，应该显示网络连接成功
3. 如果连接失败，检查：
   - 后端服务是否在 `http://192.168.33.116:3000` 正常运行
   - 防火墙是否阻止了3000端口
   - IP地址是否正确

## 🔧 快速验证命令

```bash
# 1. 检查服务器状态
curl http://192.168.33.116:3000/health

# 2. 检查AI聊天接口
curl -X POST http://192.168.33.116:3000/api/ai-chat/tutoring \
  -H "Content-Type: application/json" \
  -d '{"question":"3+2=?","studentInput":"5","subject":"math","grade":1,"currentStep":"thinking"}'

# 3. 检查OCR状态
curl http://192.168.33.116:3000/api/ocr/status
```

## 🎉 配置完成确认

如果以上验证都成功，说明IP地址配置更新完成，小程序现在可以正常连接到新的服务器地址！

**重要提醒**: 
- 每次IP地址变更时，只需要修改 `miniprogram/app.js` 中的两个地址即可
- 也可以使用小程序内置的手动IP设置功能（如果有相关页面） 